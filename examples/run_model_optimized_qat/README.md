# vehicle_optimized_qat

ESP32-P4 Vehicle Classifier - Auto-generated Project

## ğŸ“‹ Project Information

- **Variant:** optimized
- **Quantization Method:** qat
- **Model:** vehicle_classifier.espdl (2.54 MB)
- **Input Size:** 256Ã—256Ã—3
- **Test Images:** 4
- **Generated:** 2025-10-24 03:22:02

## ğŸš€ Quick Start

### Prerequisites

- ESP-IDF v5.0+ installed
- ESP32-P4 development board
- USB cable for flashing

### Build and Flash

```bash
# Configure for ESP32-P4 (if not already set)
idf.py set-target esp32p4

# Build the project
idf.py build

# Flash to device
idf.py flash

# Monitor output
idf.py monitor
```

### All-in-one Command

```bash
idf.py build flash monitor
```

## ğŸ“Š Model Details

### Architecture
- **Base Model:** MobileNetV2
- **Task:** Binary classification (Vehicle vs Not Vehicle)
- **Quantization:** INT8 (qat)

### Input Specifications
- **Format:** RGB888
- **Size:** 256Ã—256Ã—3
- **Preprocessing:** ImageNet normalization
  - Mean: [0.485, 0.456, 0.406]
  - Std: [0.229, 0.224, 0.225]

### Output
- **Classes:** 2
  - Class 0: Not Vehicle
  - Class 1: Vehicle
- **Output Format:** INT8 logits

## ğŸ§ª Test Images

The project includes 4 embedded test images for validation:

Auto-discovered from training pipeline following pattern: `classname_number.jpg`

## ğŸ“ˆ Expected Performance

Based on variant configuration:

### optimized Variant
- **Target Latency:** As per variant specifications
- **Target Accuracy:** As per variant specifications
- **Input Size:** 256Ã—256

## ğŸ”§ Modifying the Project

### Change Model

1. Replace `main/models/p4/vehicle_classifier.espdl`
2. Update `main/CMakeLists.txt` if filename changes
3. Rebuild

### Add Test Images

1. Add `.jpg` files to `main/` directory
2. Add extern declarations in `app_main.cpp`
3. Add to `embed_files` in `main/CMakeLists.txt`
4. Add test calls in `run_vehicle_classifier()`

### Adjust Configuration

Edit `sdkconfig.defaults` for:
- Clock frequency
- Memory allocation
- Flash/PSRAM settings

## ğŸ“ Output Format

The program will output:
- Model information (input/output shapes)
- Test results for each embedded image
- Latency benchmark (average over 10 iterations)
- Memory profile
- Layer-by-layer latency profile

## ğŸ› Troubleshooting

### Build Errors

**esp-dl not found:**
```
Error: Component 'esp-dl' not found
```
Solution: Check `main/idf_component.yml` has correct `override_path`

**Model file not found:**
```
Error: models/p4/vehicle_classifier.espdl not found
```
Solution: Ensure model file is copied to `main/models/p4/`

### Runtime Errors

**Model loading failed:**
- Check model file is properly embedded
- Verify model format is .espdl
- Check available flash/RAM

**Inference errors:**
- Verify input image size matches 256Ã—256
- Check preprocessing is correct
- Ensure sufficient PSRAM for inference

## ğŸ“š Project Structure

```
vehicle_optimized_qat/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ app_main.cpp          # Main application
â”‚   â”œâ”€â”€ CMakeLists.txt        # Component build config
â”‚   â”œâ”€â”€ idf_component.yml     # Dependencies
â”‚   â”œâ”€â”€ models/p4/
â”‚   â”‚   â””â”€â”€ vehicle_classifier.espdl    # Quantized model
â”‚   â””â”€â”€ *.jpg                 # Test images
â”œâ”€â”€ CMakeLists.txt            # Project build config
â”œâ”€â”€ sdkconfig.defaults        # Default SDK config
â”œâ”€â”€ partitions.csv            # Partition table
â””â”€â”€ README.md                 # This file
```

## ğŸ”— Related Files

- **Training Pipeline:** `../../pipeline.ipynb`
- **Model Source:** `../../models/optimized/qat/`
- **Documentation:** `../../README.md`

## ğŸ“„ License

Same as parent project.

---

**Auto-generated by ESP-DL Pipeline v2**  
**Generated:** 2025-10-24 03:22:02
